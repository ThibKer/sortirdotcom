{% extends 'base.html.twig' %}

{% block title %}Modifier une sortie{% endblock %}

{% block stylesheets %}
    <script src="/js/jquery.min.js"></script>
    <script src="/js/moment.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/bootstrap-datetimepicker.min.js"></script>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootstrap-datetimepicker.min.css">
{% endblock %}

{% block body %}
    <style>
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            padding-top: 100px; /* Location of the box */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0, 0, 0); /* Fallback color */
            background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
        }

        /* Modal Content */
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
        }

        /* The Close Button */
        .close {
            color: #aaaaaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
    <form method="post" class="pure-form pure-form-aligned centred-conteneur formsortie" id="formulaire-modifier">
        <fieldset>
            <!--<div class="pure-g">-->
            <div class="pure-g">
                <div class="pure-u-1-2">
                    <div class="creation-champs pure-control-group">
                        {{ form_row(formUpdate.nom) }}
                    </div>

                    <div class='creation-champs pure-control-group pickerrow'>
                        {{ form_label(formUpdate.dateHeureDebut) }}<?
                        ?>
                        <div class='input-group' id='datetimepicker1'>
                            {{ form_widget(formUpdate.dateHeureDebut) }}
                            <span class="input-group-addon">
                                <span class="glyphicon glyphicon-calendar fix16px"></span>
                            </span>
                        </div>
                    </div>

                    <div class='creation-champs pure-control-group pickerrow'>
                        {{ form_label(formUpdate.dateLimiteInscription) }}<?
                        ?>
                        <div class='input-group date' id='datetimepicker2'>
                            {{ form_widget(formUpdate.dateLimiteInscription) }}
                            <span class="input-group-addon">
                                <span class="glyphicon glyphicon-calendar fix16px"></span>
                            </span>
                        </div>
                    </div>

                    <div class="creation-champs pure-control-group">
                        {{ form_row(formUpdate.duree, { 'attr' : { 'min' : '15' , 'value' : '15'}}) }}
                    </div>
                    <div class="creation-champs pure-control-group">
                        {{ form_row(formUpdate.nbInscriptionMax) }}
                    </div>
                    <div class="creation-champs pure-control-group">
                        {{ form_row(formUpdate.infosSortie) }}
                    </div>
                </div>

                <div class="pure-u-1-2">

                    <div class="creation-champs pure-control-group">
                        {{ form_row(formUpdate.site) }}
                    </div>
                    <div class="creation-champs pure-control-group" id="select-ville">
                        <label for="select-ville-balise">Ville</label><?
                        ?><select id="select-ville-balise">
                            {% for ville in villes %}
                                <option value="{{ ville.id }}">{{ ville.nom }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="creation-champs pure-control-group" id="select-creation">
                        {{ form_row(formUpdate.lieu) }}
                        <div id="myBtn">
                            <img src="{{ asset('img/plus-circle.svg') }}" alt="add lieu">
                            new
                        </div>
                    </div>

                    <legend></legend>
                    <input type="hidden" id="id-choix-lieu" name="id-choix-lieu">

                    <div class="pure-control-group">
                        <label class="labeldisplay" for="rue-holder">Rue</label>
                        <label class="displayed labeldisplay" id="rue-holder"></label>
                    </div>
                    <div class="pure-control-group">
                        <label class="labeldisplay" for="latitude-holde">Latitude</label>
                        <label class="displayed labeldisplay" id="latitude-holder"></label>
                    </div>
                    <div class="pure-control-group">
                        <label class="labeldisplay" for="longitude-holder">Longitude</label>
                        <label class="displayed labeldisplay" id="longitude-holder"></label>
                    </div>

                    <legend></legend>

                    {{ form_rest(formUpdate) }}

                </div>
                <div class="pure-controls">
                    <!-- empty : for 'pure' disposition -->
                </div>
            </div>
        </fieldset>
        <input type="hidden" value="" id="hidden-ajout" name="hidden-data-ajout">
    </form>

    <div class="centred-conteneur">
        <div class="pure-controls">
            <button class="pure-button button-primary" type="submit" id="submit-modifier">Modifier</button>
            <a class="pure-button button-primary" href="{{ path('sortie_publication', {"id" : sortie.id}) }}">Publier la
                sortie</a>
            <a class="pure-button button-primary" href="{{ path('sortie_suppression', {"id" : sortie.id}) }}"
               onclick="alert('Attention, cette sortie ne sera visible à aucun endroit du site mais restera archivée dans la base de donnée')">Supprimer
                la sortie</a>
            <a class="pure-button button-primary" href="{{ path('home') }}">Annuler</a>
        </div>
    </div>

    <!-- The Modal -->
    <div id="myModal" class="modal">
        <!-- Modal content -->
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="pure-control-group" id="ajout-lieu-nom">
                {{ form_row(formLieu.nom) }}
            </div>
            <div class="pure-control-group" id="ajout-lieu-rue">
                {{ form_row(formLieu.rue) }}
            </div>
            <div class="pure-control-group" id="ajout-lieu-latitude">
                {{ form_row(formLieu.latitude) }}
            </div>
            <div class="pure-control-group" id="ajout-lieu-longitude">
                {{ form_row(formLieu.longitude) }}
            </div>
            <div class="pure-control-group" id="ajout-lieu-ville">
                {{ form_row(formLieu.ville) }}
            </div>
            <button id="creer-lieu" class="btn">Créer</button>
        </div>
    </div>


    <input type="hidden" value="{{ lieuxdonnees }}" id="hidden" name="hidden-data">

    <script>
        $(function () {
            $('#datetimepicker1').datetimepicker({
                format: "YYYY-MM-DD hh:mm:ss",
            });
            $('#datetimepicker2').datetimepicker({
                format: "YYYY-MM-DD hh:mm:ss",
            });
        });
    </script>
    <script>
        function villeDeBase() {
            selecteurVille = document.getElementById("select-ville-balise");
            for (i = 0; i < selecteurVille.length; i++) {
                if (selecteurVille[i].value == {{ sortie.lieu.ville.id }}) {
                    selecteurVille[i].setAttribute("selected", "selected");
                }
            }
            changementInfoLieu();
            changementLieu();
            selecteurLieu = document.getElementById('sortie_lieu');
            for (i = 0; i < selecteurLieu.length; i++) {
                if (selecteurLieu[i].value == {{ sortie.lieu.id }}) {
                    selecteurLieu[i].setAttribute("selected", "selected");
                }
            }
            changementInfoLieu();
        }
        window.onload = function() {
            villeDeBase();
        };
    </script>
    <script src="{{ asset('js/selectCreationModification.js') }}"></script>
    <script src="{{ asset('js/modification.js') }}"></script>
    <script src="{{ asset('js/creationLieu.js') }}"></script>
{% endblock %}
